\section{概述}

我们实现了一个无延迟槽的带动态分支预测的流水线CPU。我们实现了一个通用性极佳（支持软硬件中断，支持绘图）的计算机。

我们最初的目的是尽可能不插，少插气泡，由于某些冲突必须暂停流水线，我们最终仅在3种情况插1个气泡，而绝大多数时候我们都无需插气泡。我们的CPU的主频最高可以达到21M（我们使用了ISE自带的模拟器件IP核DCM来分频）对于老师给的5个测例，我们花费的时间都非常少，因为我们几乎不用插气泡，所以花费的时间约等于指令数除以主频。

为了提高运行效率，我们增加了分支预测功能，branch指令和jump指令均在decode阶段进行，从而使得因为跳转引入的气泡尽可能的少。分支预测采取的是一个大小为3的查询表，每次使用pc进行查询，如果出现一次错误则更新，即记录上一次的结果。

除了CPU的核心以外，我们做了硬件中断，软件中断，像素映射的VGA接口的显示器（由于片内的RAM容量不大，不足以存下RGB，我们的显示是蓝白的）。

由于我们是像素映射，硬件的接口不仅单一而且不利于编程（非常繁琐，由于屏幕非常大，不足以用16位表示坐标，我们得传2次参数才能确定一个点），我们用软件实现了如下几个画图的接口：（详见第六节）

\begin{enumerate}
    \item 画一个点
    \item 画一条细线段
    \item 画一条粗线段
    \item 画一个等腰直角三角形
    \item 从数据RAM中读取一个形状（用于实现字符集，比如Unicode或者ASCII）
\end{enumerate}

\section{特色}


\begin{enumerate}
    \item \textbf{多条旁路}
    \item \textbf{动态分支预测}
    \item \textbf{消除延迟槽}：我们所有的跳转指令都不需要延迟槽，也不会暂停流水线
    \item \textbf{内存统一编址}
    \item \textbf{外设·键盘}：一个支持字母，数字，空格，退格，回车，shift组合键的键盘
    \item \textbf{支持硬件中断}：支持键盘触发硬件中断，为其他设备触发硬件中断留下了接口
    \item \textbf{支持软件中断}：支持软件中断scanf
    \item \textbf{外设·屏幕}：像素映射的屏幕，我们提供了字符和图形的库
    \item \textbf{支持绘图}：比字符映射的屏幕更通用
    \item \textbf{库支持}：我们用汇编写了总共千行的代码，提供了丰富的库
    \item \textbf{专用的Term}：我们为自己打造了专用的Term，方便调试，更方便展示
\end{enumerate}